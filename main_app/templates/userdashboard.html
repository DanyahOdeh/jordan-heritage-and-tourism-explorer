{% extends "base.html" %} 
{% load static %}

{% block title %}Dashboard | Jordan Heritage & Tourism Explorer{% endblock %}

{% block head %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock head %}


{% block content %}
    
    <div class="dashboard-wrapper">
        
        <main class="main-content">
            <h1>Dashboard</h1>
            <p class="welcome-message">Welcome back, {{ user.username }}!</p>

            <div class="stat-cards-grid">
                
                <div class="stat-card">
                    <div class="number">{{ total_destinations_count }}</div>
                    <p>Destinations Added</p>
                    <p style="font-size: 0.8rem;">{{ approved_destinations_count }} Approved, {{ pending_destinations_count }} Pending</p>
                </div>
                
                <div class="stat-card">
                    <div class="number">{{ total_feedback_count }}</div>
                    <p>Reviews & Comments</p>
                    <p style="font-size: 0.8rem;">{{ user_reviews_count }} Reviews</p>
                </div>
    
                <a href="{% url 'add_destination' %}" class="stat-card add-destination-card" style="text-decoration: none;">
                    <div class="number">+</div>
                    <p>Add New Destination</p>
                </a>
            </div>

           <div class="latest-sections">
    <section class="latest-activity">
        <h3>Latest Added Destinations</h3>
        {% for destination in latest_destinations %}
            <div class="activity-item">
                <img src="{% if destination.image %}{{ destination.image.url }}{% else %}{% static 'images/default_destination.png' %}{% endif %}" alt="{{ destination.name }}">
                <div class="activity-details">
                    <strong><a href="{% url 'destination_detail' pk=destination.pk %}" style="color: inherit; text-decoration: none;">{{ destination.name }}</a></strong>
                    <p>Category: {{ destination.get_category_display }} | Added On: {{ destination.created_at|date:"M d, Y" }}</p>
                    <span class="status-badge {{ destination.status }}">{{ destination.get_status_display }}</span>
                </div>
            </div>
        {% empty %}
            <p>You haven't added any destinations yet.</p>
        {% endfor %}
    </section>

    <section class="latest-activity">
        <h3>Latest Reviews & Comments</h3>
        {% for review in latest_reviews %}
            <div class="activity-item">
                <img src="{% if review.destination.image %}{{ review.destination.image.url }}{% else %}{% static 'images/default_destination.png' %}{% endif %}" alt="{{ review.destination.name }}">
                <div class="activity-details">
                    <strong><a href="{% url 'destination_detail' pk=review.destination.pk %}" style="color: inherit; text-decoration: none;">{{ review.destination.name }}</a></strong>
                    <p>Rated: ⭐ {{ review.rating }}/5 | {{ review.created_at|date:"M d, Y" }}</p>
                    {% if review.comment %}
                        <p style="font-size: 0.9rem; color: #555;">“{{ review.comment|truncatewords:15 }}”</p>
                    {% else %}
                        <p style="font-size: 0.9rem; color: #999;">No comment added.</p>
                    {% endif %}
                </div>
            </div>
        {% empty %}
            <p>You haven't written any reviews yet.</p>
        {% endfor %}
    </section>
</div>


        </main>
    </div>

{% endblock content %}